    def {{ func_name }}(
        self,
        {% for arg in args %}
        {% if arg.is_optional == False %}
        {{ arg.name }}: {{ arg.type }},
        {% endif %}
        {% endfor %}
        {% set optional_args = args|selectattr("is_optional")|list %}
        {% if optional_args %}*,
        {% for arg in optional_args %}
        {{ arg.name }}: {{ arg.type }} = None,
        {% endfor %}
        {% endif %}
    ) {% if response_type != "" %} -> {{ response_type }} {% endif %}:
        {% if docs %}"""{{ docs }}"""{% endif %}
        
        url = "{{ url_template }}".format(self.client.base_url{% for arg in args %}{% if arg.in_url %}, {{ arg.name }}={{ arg.name }}{% endif %}{% endfor %})
        
        {% for arg in args %}
        {% if arg.in_query %}
        if {{ arg.name }} is not None:
            {% if "bool" in arg.type %}
            if "?" in url:
                url = url + "&{{ arg.name }}=" + str({{ arg.name }}).lower()
            else:
                url = url + "?{{ arg.name }}=" + str({{ arg.name }}).lower()
            {% else %}
            if "?" in url:
                url = url + "&{{ arg.name }}=" + str({{ arg.name }})
            else:
                url = url + "?{{ arg.name }}=" + str({{ arg.name }})
            {% endif %}
        {% endif %}
        {% endfor %}

        _client = self.client.get_http_client()
        {% if file_info.has_json_body_multipart %}
        # JSON + multipart endpoint
        response = upload_json_multipart(
            client=_client,
            url=url,
            json_body=body,
            file_attachments=file_attachments,
            headers=self.client.get_headers(),
        )
        {% else %}
        response = _client.{{ method }}(
            url=url,
            headers=self.client.get_headers(),
            {% if has_request_body %}{% if request_body_type != "bytes" %}content=body.model_dump_json(),{% else %}content=body,{% endif %}{% endif %}
        )
        {% endif %}

        if not response.is_success:
            from ..response_helpers import raise_for_status
            raise_for_status(response)
        
        {% if response_type and response_type != "" %}
        if not response.content:
            return None  # type: ignore
            
        json_data = response.json()
        {% if response_type.startswith('Union') or response_type.startswith('Optional[Union') or response_type.startswith('Dict') or response_type.startswith('List') or response_type.startswith('dict') or response_type.startswith('list') %}
        # Validate into annotated/collection/union types using TypeAdapter
        from pydantic import TypeAdapter
        return TypeAdapter({{ response_type }}).validate_python(json_data)
        {% else %}
        # Validate into a Pydantic model (works for BaseModel and RootModel)
        return {{ response_type }}.model_validate(json_data)
        {% endif %}
        {% else %}
        return response.json() if response.content else None
        {% endif %}
